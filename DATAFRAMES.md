# DataFrame inventory for Financial Normalizer

## Global / Engine-level DataFrames

- `raw_gl`: Raw general ledger / trial balance data as loaded from CSV. Typical columns: `Account_Code`, `Account_Name`, `Amount`, `Entity`, `Period`, `Date`.
  - Location: [financial-normalizer/src/normalization/engine.py](financial-normalizer/src/normalization/engine.py)

- `adjustments_df`: Adjustments loaded from an adjustments CSV or generated by synthetic generators. Typical columns: `Adjustment_ID`/`Journal_Entry_ID`, `Description`/`Adjustment_Name`, `Account_Code`, `Debit`, `Credit`, `Amount`, `Adjustment_Type`/`Category`, `Reason`, `Is_Recurring`.
  - Location: [financial-normalizer/src/normalization/engine.py](financial-normalizer/src/normalization/engine.py)

- `reported_income_statement`: Income statement built from GL (reported view). Typical columns: `Line_Item`, `Amount`, `Percent_of_Revenue`.
  - Location: [financial-normalizer/src/normalization/engine.py](financial-normalizer/src/normalization/engine.py)

- `normalized_income_statement`: Income statement after applying adjustments/normalizations. Same schema as `reported_income_statement`.
  - Location: [financial-normalizer/src/normalization/engine.py](financial-normalizer/src/normalization/engine.py)

- `before_after_details`: Row-level before/after comparison for each account. Typical fields: `account_code`, `account_name`, `account_type`, `before_amount`, `after_amount`, `adjustment_amount`, `adjustment_reason`, `is_recurring`, `pct_change`.
  - Location: [financial-normalizer/src/normalization/engine.py](financial-normalizer/src/normalization/engine.py)

- `adjustment_impact_analysis`: Summary table listing each adjustment and its EBITDA impact. Typical columns: `Adjustment_ID`, `Adjustment_Name`, `Category`, `Amount`, `EBITDA_Impact`, `Is_Recurring`, `Reason`.
  - Location: [financial-normalizer/src/normalization/adjustments.py](financial-normalizer/src/normalization/adjustments.py) (returned by `AdjustmentCalculator.get_adjustment_impact_analysis()`), referenced in engine.

- `eliminations`: Intercompany elimination rows produced during consolidation. Typical columns: `Entry_Type`, `Account_Eliminated`, `Amount_Eliminated`, `Reason`.
  - Location: [financial-normalizer/src/normalization/adjustments.py](financial-normalizer/src/normalization/adjustments.py) (`ConsolidationEngine.consolidate()`), used by engine.

## Ingestion & Parser DataFrames

- `df` (parser / main): Parsed transactions converted to a DataFrame in `main.py`. Typical columns: `Account_Code`, `Account_Name`, `Amount`, `Date`, `Entity`.
  - Location: [financial-normalizer/src/main.py](financial-normalizer/src/main.py)

- Parser intermediate `df` inside `TrialBalanceParser.parse()`: normalized DataFrame after reading CSV/Excel and mapping columns. Typical normalized columns include: `account` (mapped), `description`, `amount` (or `debit`/`credit`), `date`, `entity`.
  - Location: [financial-normalizer/src/ingestion/trial_balance_parser.py](financial-normalizer/src/ingestion/trial_balance_parser.py)

## Classification DataFrames

- `result_df` / `df_classified`: Output of `ClassificationEngine.classify_dataframe()` — original rows merged with classification columns. Typical columns (in addition to original): `Account_Type`, `Adjustment_Type`, `Adjustment_Name`, `Adjustment_Reason`, `Is_Recurring`.
  - Location: [financial-normalizer/src/classification/classifier.py](financial-normalizer/src/classification/classifier.py)

## Adjustments & Synthetic Generators (test data) DataFrames

- Synthetic outputs from generators (various names):
  - `me_df` (multi-entity trial balance): columns `Entity`, `Account_Code`, `Account_Name`, `Amount`, `Period`.
    - Location: [financial-normalizer/src/ingestion/synthetic_generators.py](financial-normalizer/src/ingestion/synthetic_generators.py)
  - `cur_df` (multi-currency): columns `Account_Code`, `Account_Name`, `Currency`, `Amount_Original`, `Exchange_Rate`, `Amount_USD`, `Period`.
    - Location: [financial-normalizer/src/ingestion/synthetic_generators.py](financial-normalizer/src/ingestion/synthetic_generators.py)
  - `mb_df` (mixed basis): columns `Account_Code`, `Account_Name`, `Amount`, `Basis`, `Period`.
    - Location: [financial-normalizer/src/ingestion/synthetic_generators.py](financial-normalizer/src/ingestion/synthetic_generators.py)
  - `unadj_df` (unadjusted trial balance): columns `Account_Code`, `Account_Name`, `Unadjusted_Amount`.
    - Location: [financial-normalizer/src/ingestion/synthetic_generators.py](financial-normalizer/src/ingestion/synthetic_generators.py)
  - `adj_df` (adjustments DataFrame): columns used in synthetic adjustments include `Journal_Entry_ID`, `Description`, `Account_Code`, `Debit`, `Credit`, `Adjustment_Type` (or `Adjustment_Type`), `Reason`.
    - Location: [financial-normalizer/src/ingestion/synthetic_generators.py](financial-normalizer/src/ingestion/synthetic_generators.py)

## Consolidation / Utility DataFrames

- `combined`: Temporary DataFrame produced when concatenating multiple entity DataFrames during consolidation. Contains original GL columns plus `Entity`.
  - Location: [financial-normalizer/src/normalization/adjustments.py](financial-normalizer/src/normalization/adjustments.py)

- `consolidated`: Aggregated consolidated GL (grouped by account). Typical columns: `Account_Code`, `Account_Name`, `Amount` (aggregated sum).
  - Location: [financial-normalizer/src/normalization/adjustments.py](financial-normalizer/src/normalization/adjustments.py)

## Test-suite local DataFrames

- `df` / `test_df` in `run_tests.py`: small DataFrames used for unit tests. Examples include columns `Account_Code`, `Account_Name`, `Amount`, and sometimes `Account_Type` when testing classification.
  - Location: [financial-normalizer/run_tests.py](financial-normalizer/run_tests.py)

## Quick reference — common column names across DataFrames

- Account identifiers: `Account_Code`, `Account`, `Account_Name`
- Description / label: `Description`, `Account_Name`
- Amounts: `Amount`, `Debit`, `Credit`, `Unadjusted_Amount`, `Amount_USD`, `Amount_Original`
- Entity / period: `Entity`, `Period`, `Date`
- Classification fields (added by classifier): `Account_Type`, `Adjustment_Type`, `Adjustment_Name`, `Adjustment_Reason`, `Is_Recurring`



